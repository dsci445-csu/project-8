---
title: "Slideshow-Kelsey"
subtitle: "DSCI 445"
author: "Group 8: Kelsey Britton, James Chinnery, Robin Thrush, Kaitlynn Walston"
output: 
  ioslides_presentation:
    css: styles.css
---

```{r setup, include=FALSE}
set.seed(445)
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(tidymodels)
library(knitr)
library(kableExtra)
clean_data <- read_csv("clean_movie_data.csv")
source("linreg.R")
```

## Introduction




## Data Cleaning

**Date**

  - Extracted month from "date" column 
  - Used this to assign each entry a season (Fall, Winter, Spring, Summer)
  
**Movie Title**

  - Sentiment analysis using AFINN
  - Added Punctuation

## Pure Linear Regression

- Used cleaned predictors from compiled csv
- Fit on log(gross) scale for stability
- Predictions were coverted back on dollars scale

## Model Performance

**$R^2$ = 0.594**

**RMSE = $42.3 million**

## 

```{r}
significant_table <- tidy(lm_full) %>%
  filter(p.value < 0.05) %>%
  mutate(
    pct_impact = round((exp(estimate) - 1) * 100, 2),
    p.value = signif(p.value, 3)
  ) %>%
  arrange(desc(abs(pct_impact))) %>%
    select(
    Predictor = term,
    `Percent Impact on Gross` = pct_impact,
    `p-value` = p.value) 

top10_table <- significant_table %>%
  slice(1:10)
  
top10_table %>%
  kable(format = "html", caption = "Most Significant Predictors") %>%
  kable_styling(full_width = FALSE)
```

##

```{r}
preds_log <- fitted(lm_full)
preds_dollars <- exp(preds_log) - 1

obs_log <- lm_full$model$gross
obs_dollars <- exp(obs_log) - 1

plot_df <- data.frame(
  Actual = obs_dollars,
  Predicted = preds_dollars
)

ggplot(plot_df, aes(x = Actual, y = Predicted)) +
  geom_point(alpha = 0.3) +
  geom_abline(intercept = 0, slope = 1, color = "red", size = 1) +
  scale_x_continuous(labels = scales::dollar) +
  scale_y_continuous(labels = scales::dollar) +
  labs(
    title = "Predicted vs Actual Gross Revenue",
    x = "Actual Gross (USD)",
    y = "Predicted Gross (USD)"
  ) +
  theme_minimal()
```

